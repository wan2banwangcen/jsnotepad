var np={config:{appContainer:".notepad-app"},bShowStatusBar:!0,bLinerWrap:!1};$(function(){$menuber.init(),$editor.init(),$statusbar.init()});var $dlgAbout=function(){var e=$('<div class="notepad-dlg-about"><div class="dialogbox notepad-dlgbox"><div class="notepad-dlg-titlebar"><p class="title">关于“记事本”</p><span class="btn-close">✖</span></div><div class="main notepad-dlg-main"><h1 class="slogan">JSNotepad</h1><hr><img class="logo" src="../images/notepad-icon-32.png" alt="JSNotepad"><div class="info"><p>作者：王岑</p><p>QQ：71596415</p><p>仓库地址：<a href="https://github.com/wan2banwangcen/spa-demo" target="_blank">https://github.com/wan2banwangcen/spa-demo</a></p></div><input class="btn-ok" type="button" value="确定"></div></div></div>'),t=e.find(".btn-ok"),l=e.find(".btn-close"),n=e.find(".notepad-dlg-titlebar");function a(){e.remove()}return{init:function(){$("body").append(e),e.find(".dialogbox").draggable({handle:n}),t.click(a),l.click(a)}}}(),$dlgFont=function(){var t=$('<div class="notepad-dlg-mask notepad-dlg-font"><div class="dialogbox notepad-dlgbox"><div class="notepad-dlg-titlebar"><p class="title">字体</p><span class="btn-close" title="取消">✖</span></div><div class="main notepad-dlg-main"><div class="font-family"><p>字体(F):</p></div><div class="font-style"><p>格式(Y):</p></div><div class="font-size"><p>大小(S):</p></div><fieldset class="sample"><legend>示例</legend><p class="sample-txt">SeHhUuNn</p></fieldset><div class="script"><label>脚本(R):<br><select><option value="西欧语言">西欧语言</option><option value="中文 GB2312">中文 GB2312</option></select> </label></div><input class="btn-ok btn" type="button" value="确定"><input class="btn-cancel btn" type="button" value="取消"></div></div></div>'),l=t.find(".btn-close"),n=t.find(".btn-cancel"),a=t.find(".notepad-dlg-titlebar"),i=t.find(".btn-ok"),e=t.find(".sample-txt");function s(){t.remove()}var c=["Agency FB","Algerian","Arial","Arial Rounded MT","Axure Handwriting","Bahnschrift","Baskerville Old Face","Bauhaus 93","Bell MT","Berlin Sans FB","Bernard MT","BlackAdder ITC"],d=["斜体","粗体","常规","粗偏斜体"],o=["8","9","10","11","12","14","16","18","20","22","24","26","28","36","48","72"],r={family:"Arial",style:"常规",size:"16",okHandler:null};function p(){e.css({"font-family":r.family,"font-size":r.size+"pt"}),"斜体"!==r.style?"粗体"!==r.style?"粗偏斜体"!==r.style||e.css({"font-wight":"bold","font-style":"italic"}):e.css({"font-weight":"bold"}):e.css({"font-style":"italic"})}return{show:function(e){$.extend(r,e),$("body").append(t),(new comList).show({container:".notepad-dlg-font .font-family",width:"176px",list:c,select:c.indexOf(r.family),isFont:!0,selectHandler:function(e){r.family=c[e],p()}}),(new comList).show({container:".notepad-dlg-font .font-style",width:"132px",list:d,select:d.indexOf(r.style),isFontStyle:!0,selectHandler:function(e){r.style=d[e],p()}}),(new comList).show({container:".notepad-dlg-font .font-size",width:"64px",list:o,select:o.indexOf(r.size),selectHandler:function(e){r.size=o[e],p()}}),p(),t.find(".dialogbox").draggable({handle:a}),l.click(s),n.click(s),i.click(function(){r.okHandler({family:r.family,style:r.style,size:r.size}),s()}),t.click(function(e){e.stopPropagation()})}}}(),$dlgGoto=function(){var t=$('<div class="notepad-dlg-mask notepad-dlg-goto"><div class="dialogbox notepad-dlgbox"><div class="notepad-dlg-titlebar"><p class="title">转到指定行</p><span class="btn-close">✖</span></div><div class="main notepad-dlg-main"><lable for="">行号(L):</lable><br><input class="line-num" type="text" autofocus><br><input class="btn-goto" type="button" value="转到"><input class="btn-cancel" type="button" value="取消"></div></div>'),l=t.find(".btn-close"),n=t.find(".btn-cancel"),a=t.find(".notepad-dlg-titlebar"),i=t.find(".btn-goto"),s=t.find(".line-num"),c={curLine:1,total:1,gotoHandler:null};function d(){t.remove()}function o(){!function(){var e=Number(s.val());return!(0===e||e>c.total)||(alert("行数超过总行数"),!1)}()||(c.gotoHandler(s.val()),d())}function r(e){/[0-9]/.test(e.key)||(e.preventDefault(),alert("不能输入数字以外的字符"))}return{init:function(e){$.extend(c,e),$("body").append(t),t.find(".dialogbox").draggable({handle:a}),s.val(c.curLine),s.select(),l.click(d),n.click(d),i.click(o),s.keypress(r)}}}(),$dlgReplace=function(){var t=$('<div class="notepad-dlg-replace"><div class="dialogbox notepad-dlgbox"><div class="notepad-dlg-titlebar"><p class="title">替换</p><span class="btn-close">✖</span> </div><div class="main notepad-dlg-main"><label for="">查找内容(N):<input class="txt-search" autofocus><br></label><label>替换为(P):<input class="txt-replace"><br></label><label><input type="checkbox" value="capital-sense">区分大小写(C)</label><input class="btn-search btn" type="button" value="查找下一个(F)"><input class="btn-replace btn" type="button" value="替换(R)"><input class="btn-replace-all btn" type="button" value="全部替换(A)"><input class="btn-cancel btn" type="button" value="取消"></div></div></div>'),l={searchHandler:null,replaceHandler:null,replaceAllHandler:null},n=t.find(".btn-close"),a=t.find(".btn-cancel"),i=t.find(".btn-search"),s=t.find(".btn-replace"),c=t.find(".btn-replace-all"),d=t.find(".txt-search"),o=t.find(".txt-replace"),r=t.find(".notepad-dlg-titlebar");function p(){t.remove()}function u(){""!==d.val()?b(!0):b(!1)}function b(e){e?(i.removeAttr("disabled"),s.removeAttr("disabled"),c.removeAttr("disabled")):(i.attr("disabled","disabled"),s.attr("disabled","disabled"),c.attr("disabled","disabled"))}function e(){return{search:d.val(),replace:o.val(),capitalSense:"capital-sense"===t.find('input[type="checkbox"]:checked').val()}}function f(){l.searchHandler(e())}function v(){l.replaceHandler(e())}function h(){l.replaceAllHandler(e())}return{show:function(e){$.extend(l,e),$("body").append(t),t.find(".dialogbox").draggable({handle:r}),d.val(""),o.val(""),d.focus(),b(t.find('input[value="capital-sense"]')[0].checked=!1),n.click(p),a.click(p),d.keyup(u),i.click(f),s.click(v),c.click(h)}}}(),$dlgSearch=function(){var t=$('<div class="notepad-dlg-search"><div class="dialogbox notepad-dlgbox"><div class="notepad-dlg-titlebar"><p class="title">查找</p><span class="btn-close">✖</span></div><div class="main notepad-dlg-main"><label>查找内容(N):<input class="txt-content" type="text" autofocus></label><br><label><input type="checkbox" value="capital-sense">区分大小写(C)</label><fieldset class="search-direction"><legend>方向</legend><label><input type="radio" name="direction" value="up">向上(U)</label><label><input type="radio" name="direction" value="down" checked>向下(D)</label></fieldset><input class="btn-search btn" type="button" value="查找下一个(F)" disabled><input class="btn-cancel btn" type="button" value="取消"></div></div></div>'),l=t.find(".btn-close"),n=t.find(".btn-cancel"),a=t.find(".notepad-dlg-titlebar"),i=t.find(".btn-search"),s=t.find(".txt-content");function c(){t.remove()}function d(){""!==s.val()?i.removeAttr("disabled"):i.attr("disabled","disabled")}return{show:function(e){$("body").append(t),t.find(".dialogbox").draggable({handle:a}),t.find('input[value="up"]').removeAttr("checked"),t.find('input[value="down"]')[0].checked=!0,t.find('input[type="checkbox"]').removeAttr("checked"),i.attr("disabled","disabled"),s.val(""),s.focus(),l.click(c),n.click(c),s.keyup(d),i.click(function(){e({content:s.val(),capitalSense:"capital-sense"===t.find('input[type="checkbox"]:checked').val(),direction:t.find('input[name="direction"]:checked').val()})})}}}();function comList(){var a,t=$('<div class="notepad-com-list"><input class="editor" type="text"><br><ul class="list"></ul></div>'),l=t.find(".editor"),i=t.find(".list"),s={container:"",list:[],select:0,width:"200px",isFont:!1,isFontStyle:!1,selectHandler:null};function n(){var e=$(s.container).find(".notepad-com-list");0!==e.lenfth&&e.remove(),$(s.container).append(t),t.css({width:s.width}),function(){var e,t,l,n=0;if(s.isFont)for(n=0;n<s.list.length;n++)(e=$('<li class="item"></li>')).css({"font-family":s.list[n]}),i.append(e.html(s.list[n]));else if(s.isFontStyle)for(n=0;n<s.list.length;n++)e=$('<li class="item"></li>'),t=e,"斜体"!==(l=s.list[n])?"粗体"!==l?"粗偏斜体"!==l||t.css({"font-weight":"bold","font-style":"italic"}):t.css({"font-weight":"bold"}):t.css({"font-style":"italic"}),i.append(e.html(s.list[n]));else for(n=0;n<s.list.length;n++)e=$('<li class="item"></li>'),i.append(e.html(s.list[n]));a=i.find(".item")}(),function(e){$(a[e]).addClass("selected"),l.val(s.list[e]),l.select()}(s.select)}this.show=function(e){$.extend(s,e),n(),i.click(function(e){$(a[s.select]).removeClass("selected"),s.select=s.list.indexOf($(e.target).html()),$(a[s.select]).addClass("select"),l.val(s.list[s.select]),l.select(),s.selectHandler(s.select)}),l.keyup(function(){var e=0;for(e=0;e<s.list.length&&0!==s.list[e].indexOf(l.val());e++);e!==s.list.length&&(a[e].scrollIntoView({behavior:"smooth",block:"start"}),$(a[s.select]).removeClass("selected"),$(a[e]).addClass("selected"),s.select=e)})}}var menuData=[{title:"文件(F)",width:"202px",left:0,items:[{title:"新建(N)",shortcut:"Ctrl+N",enabled:!0,handler:function(){console.log("menu clicked(新建)")}},{title:"打开(O)",shortcut:"Ctrl+O",enabled:!0,handler:function(){console.log("menu clicked 打开(O)")}},{title:"保存(S)",shortcut:"Ctrl+S",enabled:!0,handler:function(){console.log("menu clicked 保存(S)")}},{title:"另存为(A)...",shortcut:"",enabled:!0,handler:function(){console.log("menu clicked 另存为(A)")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"页面设置(U)...",shortcut:"",enabled:!0,handler:function(){console.log("menu clicked 页面设置(U)")}},{title:"打印(P)...",shortcut:"Ctrl+P",enabled:!0,handler:function(){console.log("menu clicked 打印(P)")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"退出(X)",shortcut:"",enabled:!0,handler:function(){console.log("menu clicked 退出(X)")}}]},{title:"编辑(E)",width:"218px",left:"55px",items:[{title:"撤销(U)",shortcut:"Ctrl+Z",enabled:!0,handler:function(){console.log("menu clicked 撤销(U)")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"剪切(T)",shortcut:"Ctrl+X",enabled:!0,handler:function(){console.log("menu clicked 剪切(T)")}},{title:"复制",shortcut:"Ctrl+C",enabled:!0,handler:function(){console.log("menu clicked 复制(C)")}},{title:"粘贴(P)",shortcut:"Ctrl+P",enabled:!0,handler:function(){console.log("menu clicked 粘贴(P)")}},{title:"删除(L)",shortcut:"Del",enabled:!0,handler:function(){console.log("menu clicked 删除(L)")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"查找(F)",shortcut:"Ctrl+F",enabled:!0,handler:function(){console.log("menu clicked 查找(F)")}}]}],$menubar=function(){var c=$('<div class="notepad-menubar"><ul class="titles"></ul></div>'),d=null,l=c.find(".titles");return{show:function(e){d=e,$("body").append(c),function(){for(var e=0;e<d.length;e++){var t=$('<li class="menu-title"></li>');t.html(d[e].title),console.log(d[e].title),l.append(t)}}(),function(){for(var e=0;e<d.length;e++){for(var t=d[e].items,l=$('<ul class="menus"></ul>'),n=0;n<t.length;n++)if("hr"!==t[n].title){var a=$('<li class="menu-item"></li>');if(a.html(t[n].title),t[n].enabled||a.addClass("disabled"),""!==t[n].shortcut){var i=$('<span class="shortcut"></span>');i.html(t[n].shortcut),a.append(i)}l.append(a)}else{var s=$('<li class="menu-hr"></li>');l.append(s)}l.css({width:d[e].width,left:d[e].left}),c.append(l)}}()}}}(),$statuBar=function(){var t=$('<div class="notepad-statubar"><div class="left-panel"></div><div class="right-panel"><p class="row-col"></p></div></div>'),l=t.find(".row-col"),n="第&nbsp;x&nbsp;行，第&nbsp;y&nbsp;列",a={row:1,col:1};function i(e,t){l.html(n.replace("x",e).replace("y",t))}return{init:function(e){$.extend(a,e),i(a.row,a.col),$("body").append(t)},setRowCol:i,display:function(e){e?t.css("display","block"):t.css("display","none")}}}();